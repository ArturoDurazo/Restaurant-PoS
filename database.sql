CREATE DATABASE pos_db;

\connect pos_db

CREATE TABLE public.categories (
    category_id integer NOT NULL,
    category_name text
);

ALTER TABLE public.categories ALTER COLUMN category_id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public."Category_ID_seq"
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    MAXVALUE 50
    CACHE 1
);

CREATE TABLE public.items (
    category integer,
    item_id integer NOT NULL,
    item_name text,
    food_image text,
    price integer,
    description text,
    available boolean
);

ALTER TABLE public.items ALTER COLUMN item_id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.items_item_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    MAXVALUE 20
    CACHE 1
);

CREATE TABLE public.ordered_items (
    item_id integer,
    transaction_id integer
);

CREATE TABLE public.transactions (
    date date,
    transaction_id integer NOT NULL,
    total integer,
    status integer,
    created_at timestamp without time zone
);

ALTER TABLE public.transactions ALTER COLUMN transaction_id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.transaction_transaction_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

ALTER TABLE ONLY public.categories
    ADD CONSTRAINT "Category_pkey" PRIMARY KEY (category_id);

ALTER TABLE ONLY public.transactions
    ADD CONSTRAINT "Transaction_pkey" PRIMARY KEY (transaction_id);

ALTER TABLE ONLY public.items
    ADD CONSTRAINT item_id PRIMARY KEY (item_id);

ALTER TABLE ONLY public.items
    ADD CONSTRAINT category_id FOREIGN KEY (category) REFERENCES public.categories(category_id);

ALTER TABLE ONLY public.ordered_items
    ADD CONSTRAINT item_id FOREIGN KEY (item_id) REFERENCES public.items(item_id);

ALTER TABLE ONLY public.ordered_items
    ADD CONSTRAINT transaction_id FOREIGN KEY (transaction_id) REFERENCES public.transactions(transaction_id);

INSERT INTO public.categories VALUES (1, 'Drinks');
INSERT INTO public.categories VALUES (2, 'Meals');
INSERT INTO public.categories VALUES (3, 'Desserts');

INSERT INTO public.items VALUES (3, 16, 'Cheese Cake', 'cheesecake', 8, 'New York style', true);
INSERT INTO public.items VALUES (1, 4, 'Root Beer', 'rootbeer', 6, 'Standard Root Beer', true);
INSERT INTO public.items VALUES (1, 8, 'Orange Juice', 'orangejuice', 4, 'Fresh Orange Juice', true);
INSERT INTO public.items VALUES (3, 17, 'Vanilla Ice Cream', 'vanilla', 5, 'For old-fashioned fellas', true);
INSERT INTO public.items VALUES (2, 11, 'Hamburger', 'hamburger', 12, 'Classic american burger with bacon', true);
INSERT INTO public.items VALUES (2, 14, 'Pepperoni Pizza', 'pepperonipizza', 18, 'Big enough to share with friends and family', true);
INSERT INTO public.items VALUES (1, 5, 'Fanta', 'fanta', 6, 'Standard Fanta', true);
INSERT INTO public.items VALUES (1, 7, 'Coffee', 'coffee', 4, 'Regular Coffee', true);
INSERT INTO public.items VALUES (1, 1, 'Regular Coke', 'coke', 6, 'The classic Coke, cant go wrong with this one.', true);
INSERT INTO public.items VALUES (1, 2, 'Sprite', 'sprite', 6, 'The refreshing Sprite', true);
INSERT INTO public.items VALUES (1, 3, 'Dr Pepper', 'drpepper', 6, 'For mad scientists only', true);
INSERT INTO public.items VALUES (1, 6, 'Iced Tea', 'tea', 4, 'Ice cold tea', true);
INSERT INTO public.items VALUES (1, 9, 'Lemonade', 'lemonade', 4, 'Ice cold lemonade', true);
INSERT INTO public.items VALUES (1, 10, 'Hibiscus', 'hibiscus', 4, 'Imported from Mexico', true);
INSERT INTO public.items VALUES (2, 12, 'Hot Dog', 'hotdog', 6, 'Classic american Hot Dog with chili beans', true);
INSERT INTO public.items VALUES (2, 13, 'Nachos', 'nachos', 8, 'Nachos with home-made Cheese', true);
INSERT INTO public.items VALUES (2, 15, 'Caesar Salad', 'caesarsalad', 12, 'A classic directly from Tijuana', true);
INSERT INTO public.items VALUES (3, 18, 'Chocolate Ice Cream', 'chocolate', 5, 'For the adventurous fellas', true);
INSERT INTO public.items VALUES (3, 19, 'Strawberry Ice Cream', 'strawberry', 5, 'For the wild fellas', true);
INSERT INTO public.items VALUES (3, 20, 'Apple Pie Slice', 'apple', 7, 'Freshly Baked', true);

INSERT INTO public.ordered_items VALUES (1, 40);
INSERT INTO public.ordered_items VALUES (1, 41);
INSERT INTO public.ordered_items VALUES (1, 42);
INSERT INTO public.ordered_items VALUES (1, 43);
INSERT INTO public.ordered_items VALUES (2, 43);
INSERT INTO public.ordered_items VALUES (2, 41);
INSERT INTO public.ordered_items VALUES (1, 50);
INSERT INTO public.ordered_items VALUES (5, 50);
INSERT INTO public.ordered_items VALUES (1, 51);
INSERT INTO public.ordered_items VALUES (2, 51);
INSERT INTO public.ordered_items VALUES (3, 51);
INSERT INTO public.ordered_items VALUES (6, 51);
INSERT INTO public.ordered_items VALUES (11, 51);
INSERT INTO public.ordered_items VALUES (14, 51);
INSERT INTO public.ordered_items VALUES (12, 51);
INSERT INTO public.ordered_items VALUES (13, 51);
INSERT INTO public.ordered_items VALUES (12, 51);
INSERT INTO public.ordered_items VALUES (15, 51);
INSERT INTO public.ordered_items VALUES (17, 51);
INSERT INTO public.ordered_items VALUES (18, 51);
INSERT INTO public.ordered_items VALUES (19, 51);
INSERT INTO public.ordered_items VALUES (20, 52);
INSERT INTO public.ordered_items VALUES (16, 52);
INSERT INTO public.ordered_items VALUES (19, 52);
INSERT INTO public.ordered_items VALUES (17, 52);
INSERT INTO public.ordered_items VALUES (18, 52);
INSERT INTO public.ordered_items VALUES (11, 52);
INSERT INTO public.ordered_items VALUES (14, 52);
INSERT INTO public.ordered_items VALUES (15, 52);
INSERT INTO public.ordered_items VALUES (12, 52);
INSERT INTO public.ordered_items VALUES (1, 52);
INSERT INTO public.ordered_items VALUES (4, 52);
INSERT INTO public.ordered_items VALUES (7, 52);
INSERT INTO public.ordered_items VALUES (8, 52);
INSERT INTO public.ordered_items VALUES (9, 52);
INSERT INTO public.ordered_items VALUES (10, 52);
INSERT INTO public.ordered_items VALUES (3, 52);
INSERT INTO public.ordered_items VALUES (2, 52);
INSERT INTO public.ordered_items VALUES (5, 53);
INSERT INTO public.ordered_items VALUES (8, 53);
INSERT INTO public.ordered_items VALUES (4, 53);
INSERT INTO public.ordered_items VALUES (3, 53);
INSERT INTO public.ordered_items VALUES (16, 53);
INSERT INTO public.ordered_items VALUES (11, 53);
INSERT INTO public.ordered_items VALUES (11, 53);
INSERT INTO public.ordered_items VALUES (11, 53);
INSERT INTO public.ordered_items VALUES (11, 53);
INSERT INTO public.ordered_items VALUES (14, 54);
INSERT INTO public.ordered_items VALUES (15, 54);
INSERT INTO public.ordered_items VALUES (12, 54);
INSERT INTO public.ordered_items VALUES (11, 54);
INSERT INTO public.ordered_items VALUES (17, 54);
INSERT INTO public.ordered_items VALUES (19, 54);
INSERT INTO public.ordered_items VALUES (1, 54);
INSERT INTO public.ordered_items VALUES (4, 54);
INSERT INTO public.ordered_items VALUES (1, 55);
INSERT INTO public.ordered_items VALUES (4, 55);
INSERT INTO public.ordered_items VALUES (2, 55);

INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2019-12-19', 40, 20, 2, '2020-01-06 23:11:01.831544');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-01-06', 41, 30, 1, '2020-01-06 23:12:37.196132');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-01-06', 43, 26, 1, '2020-01-06 23:12:37.196132');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-01-06', 44, 27, 2, '2020-01-06 23:12:37.196132');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-01-06', 45, 28, 2, '2020-01-06 23:12:37.196132');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-01-06', 42, 25, 2, '2020-01-06 23:12:37.196132');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-02-03', 50, 12, 1, '2020-02-03 19:59:16.475209');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-02-03', 51, 99, 1, '2020-02-03 20:02:37.16594');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-02-03', 52, 118, 1, '2020-02-03 20:02:49.626778');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-02-03', 53, 78, 1, '2020-02-03 20:02:58.016506');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-02-03', 54, 70, 1, '2020-02-03 20:03:07.211438');
INSERT INTO public.transactions OVERRIDING SYSTEM VALUE VALUES ('2020-02-27', 55, 18, 1, '2020-02-27 21:47:53.929522');
